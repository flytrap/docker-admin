[databases]
managerdb = host=haproxy port=5000 dbname=managerdb application_name=pgbouncer-managerdb
postgres = host=haproxy port=5000 dbname=postgres application_name=pgbouncer-postgres

[pgbouncer]
listen_addr = 0.0.0.0
listen_port = 6432

auth_type = scram-sha-256
auth_query = SELECT usename, passwd FROM pg_shadow WHERE usename=$1
auth_user = postgres
auth_file = /etc/pgbouncer/userlist.txt

ignore_startup_parameters = extra_float_digits, search_path
query_wait_timeout = 120
query_timeout = 300

pool_mode = transaction

max_client_conn = 5000
default_pool_size = 300
reserve_pool_size = 50
reserve_pool_timeout = 5
max_db_connections = 350
max_user_connections = 350

server_idle_timeout = 60
server_lifetime = 300
server_connect_timeout = 15
server_reset_query = DISCARD ALL
client_idle_timeout = 300

admin_users = postgres
stats_users = postgres

log_connections = 1
log_disconnections = 1
